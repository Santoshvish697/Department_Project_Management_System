CREATE TABLE USERS (
Email VARCHAR(100) PRIMARY KEY,
PASSWORD VARCHAR(50) NOT NULL UNIQUE
);

DESCRIBE DELIVERABLE_PROJECT;

DESCRIBE guide;

USE DEPT_PROJECT;
SHOW TABLES;

SELECT * FROM DELIVERABLE_PROJECT;
SELECT * FROM DELIVERABLE_PROJECT;

SELECT * FROM GUIDE;

CREATE TABLE STUDENT (
USN VARCHAR(25) PRIMARY KEY,
First_Name VARCHAR(25),
Middle_Name VARCHAR(25),
Last_Name VARCHAR(25),
Email VARCHAR(50) NOT NULL UNIQUE,
Phone_no VARCHAR(15),
FOREIGN KEY (Email) REFERENCES USERS (Email) ON DELETE CASCADE
);

CREATE TABLE PANEL_MEMBERS (
Panel_ID INT(11) PRIMARY KEY auto_increment,
USN VARCHAR(25),
FOREIGN KEY (USN) REFERENCES STUDENT(USN)
);

SELECT * FROM PANEL_MEMBERS;

SELECT * FROM GUIDE;
SELECT * FROM DIARY;
ALTER TABLE GUIDE DROP FOREIGN KEY guide_ibfk_3;
ALTER TABLE GUIDE DROP COLUMN DIARY_ID;
DROP TABLE IF EXISTS DELIVERABLE_PROJECT;
CREATE TABLE DELIVERABLE_PROJECT (
Project_ID INT PRIMARY KEY AUTO_INCREMENT,
Project_Title VARCHAR(50) UNIQUE,
Late_Submission BOOLEAN,
Project_Objective VARCHAR(150),
Project_Outcome VARCHAR(150),
Project_Domain VARCHAR(100),
-- Submission varbinary(100),
Panel_ID INT (11),
USN VARCHAR(25),
FOREIGN KEY (Panel_ID) REFERENCES PANEL_MEMBERS(Panel_ID) ON DELETE SET NULL,
FOREIGN KEY (USN) REFERENCES STUDENT(USN)
);

DROP TABLE IF EXISTS DIARY;
CREATE TABLE DIARY (
ID INT(11) PRIMARY KEY AUTO_INCREMENT,
DATE DATE,
COMMENTS VARCHAR(100),
WORK_DONE VARCHAR(100),
USN VARCHAR(25),
FOREIGN KEY (USN) REFERENCES STUDENT(USN) ON DELETE CASCADE
);

DROP TABLE IF EXISTS GUIDE;
CREATE TABLE GUIDE (
Guide_ID VARCHAR(25) PRIMARY KEY,
First_Name VARCHAR(25),
Middle_Name VARCHAR(25),
Last_Name VARCHAR(25),
Email VARCHAR(100) NOT NULL UNIQUE,
Phone_No VARCHAR(15),
Project_ID INT(11),
USN VARCHAR(25),
ID INTEGER(11),
FOREIGN KEY (Project_ID) REFERENCES DELIVERABLE_PROJECT(Project_ID),
FOREIGN KEY (USN) REFERENCES STUDENT(USN),
FOREIGN KEY (ID) REFERENCES DIARY(ID) ON DELETE SET NULL,
FOREIGN KEY (Email) REFERENCES USERS(Email)
);

CREATE TABLE COORDINATOR (
Department_Name VARCHAR(25) PRIMARY KEY,
Panel_ID INT(11),
ID VARCHAR(25),
USN VARCHAR(25),
Email VARCHAR(25),
FOREIGN KEY (Email) REFERENCES USERS(Email) ON DELETE CASCADE,	
FOREIGN KEY (ID) REFERENCES GUIDE(Guide_ID) ON DELETE SET NULL,
FOREIGN KEY (USN) REFERENCES STUDENT(USN),
FOREIGN KEY (Panel_ID) REFERENCES PANEL_MEMBERS(Panel_ID)
);


CREATE TABLE INTERNSHIP_GUIDE (
Intern_ID INT(11) auto_increment,
FIRST_NAME VARCHAR(25),
MIDDLE_NAME VARCHAR(25),
LAST_NAME VARCHAR(25),
COMPANY VARCHAR(25),
DOJ DATE,
FOREIGN KEY (Intern_ID) REFERENCES PANEL_MEMBERS(Panel_ID)
);

CREATE TABLE GUIDE_DOMAIN (
ID VARCHAR(25),
DOMAIN VARCHAR(25),
FOREIGN KEY (ID) REFERENCES GUIDE(GUIDE_ID) ON DELETE CASCADE,
PRIMARY KEY(ID)
);

CREATE TABLE GUIDE_ALLOT (
Panel_ID INT(11),
ID VARCHAR(25),
FOREIGN KEY (Panel_ID) REFERENCES PANEL_MEMBERS(Panel_ID) ON DELETE CASCADE,
FOREIGN KEY (ID) REFERENCES GUIDE(Guide_ID),
PRIMARY KEY (Panel_ID,ID)
);

SELECT * FROM PANEL_ALLOT;
SELECT * FROM PHASE_ALLOT;

SELECT * FROM USERS;

SELECT * FROM STUDENT;
SELECT * FROM USERS;
UPDATE USERS SET PASSWORD = 'admin' WHERE EMAIL = 'ise2020@rvce.edu.in';
INSERT INTO USERS VALUES
('santoshv.is20@rvce.edu.in','root'),
('pritishraj.is20@rvce.edu.in','root2'),
('pulkitgarg.is20@rvce.edu.in','root3'),
('shankartejasvi.is20@rvce.edu.in','cust045'),
('anushkajindal.is20@rvce.edu.in','cust006');

INSERT INTO STUDENT VALUES
  ('1RV20IS043','SANTHOSH','','Vishwanathan','santoshv.is20@rvce.edu.in',9832784529),
  ('1RV20IS035','PRITISH','','RAJ','pritishraj.is20@rvce.edu.in',9472682396),
('1RV20IS036','PULKIT','','GARG','pulkitgarg.is20@rvce.edu.in',6397735901),
  ('1RV20IS045','SHANKAR','','TEJASVI','shankartejasvi.is20@rvce.edu.in',9832784529),
  ('1RV20IS006','ANUSHKA','','JINDAL','anushkajindal.is20@rvce.edu.in',941302389);
  
INSERT INTO PANEL_MEMBERS (PANEL_ID,USN) VALUES (105,'1RV20IS035');
INSERT INTO PANEL_MEMBERS (PANEL_ID,USN) VALUES (100,'1RV20IS043');
INSERT INTO PANEL_MEMBERS (PANEL_ID,USN) VALUES (104,'1RV20IS035');
INSERT INTO PANEL_MEMBERS (PANEL_ID,USN) VALUES (105,'1RV20IS035');



INSERT INTO DELIVERABLE_PROJECT (Project_ID,Project_Title,Late_Submission,Project_Objective,
Project_Outcome,Project_Domain,Panel_ID,USN) VALUES 
('1006','Department Project Management System',TRUE,'Games','App','DBMS','100','1RV20IS043'),
('1003','Diabetes Prediction',FALSE,'To predict diabetes in patients','Website','DBMS','103','1RV20IS045'),
('1004','Alzheimers Prediction',TRUE,'To predict Alzheimers','Website','AIML','104','1RV20IS006'),
('1005','Department Project',FALSE,'Chat App','Website','DBMS','102','1RV20IS036');


INSERT INTO USERS VALUES
('amit@rvce.edu.in','123232'),
('amit21@rvce.edu.in','32811'),
('amit22@rvce.edu.in','443943'),
('amit23@rvce.edu.in','4439433'),
('ami323t@rvce.edu.in','443923');

INSERT INTO USERS VALUES ('ise2020@rvce.edu.in','root1233');

INSERT INTO GUIDE (Guide_ID,First_Name,Middle_Name,Last_Name,Email,Phone_No,Project_ID,USN,ID) VALUES
('1201','Amit','M','Agarwal','amit@rvce.edu.in',4890239881,1003,'1RV20IS035',10003),
('1202','Samit','M','Agarwal','amit21@rvce.edu.in',4890267981,1004,'1RV20IS035',10004),
('1203',',Mamit','M','Agarwal','amit22@rvce.edu.in',489023981,1005,'1RV20IS035',10005),
('1204','Kamit','S','Agarwal','amit23@rvce.edu.in',4890234481,1006,'1RV20IS035',10006);

INSERT INTO COORDINATOR (DEPARTMENT_NAME,PANEL_ID,ID,USN,EMAIL) VALUES
('ISE','100','1201','1RV20IS043','ise2020@rvce.edu.in');


INSERT INTO GUIDE_DOMAIN(ID,DOMAIN) VALUES
('1201','AIML'),
('1202','NLP'),
('1203','CNN'),
('1204','WSN');

INSERT INTO GUIDE_ALLOT(Panel_ID,ID) VALUES
('100','1201'),
('103','1202'),
('104','1203'),
('105','1204');

INSERT INTO INTERNSHIP_GUIDE(INTERN_ID,FIRST_NAME,MIDDLE_NAME,LAST_NAME,COMPANY,DOJ) VALUES
('100','RAM','','KUMAR','ADOBE','2001-02-02'),
('103','RAMA','','KUMARI','MICROSOFT','2007-12-02'),
('102','RAJ','','KUMAR','GOOGLE','2004-12-02'),
('104','HARSH','','AGRAWAL','UIPATH','2002-12-02');

SELECT * FROM PANEL_MEMBERS;
SELECT * FROM DELIVERABLE_PROJECT;
SELECT * FROM USERS;
SELECT * FROM DIARY;
SHOW TABLES;
SELECT * FROM GUIDE;
SELECT * FROM PHASE_ALLOT;
SELECT * FROM DELIVERABLE_PROJECT;
SELECT * FROM PHASE_ALLOT;
SELECT PHASE_NO,DUE_DATE,LATE_SUBMISSION FROM PHASE_ALLOT;

alter table PHASE_ALLOT ADD late_submission INTEGER;

UPDATE PHASE_ALLOT SET PHASE_NO = 2 WHERE PHASE_ID = 1304;

UPDATE PHASE_ALLOT SET LATE_SUBMISSION = 0 WHERE PROJECT_ID IS NOT NULL;

SELECT * FROM DELIVERABLE_PROJECT;

SELECT * FROM GUIDE;
DESCRIBE PHASE_ALLOT;
CREATE TABLE PANEL_ALLOT (
ALLOT_NUM INTEGER PRIMARY KEY AUTO_INCREMENT,
GUIDE_ID VARCHAR(25),
PANEL_ID INTEGER,
FOREIGN KEY (GUIDE_ID) REFERENCES GUIDE(GUIDE_ID),
FOREIGN KEY (PANEL_ID) REFERENCES PANEL_MEMBERS(PANEL_ID)
);

SELECT * FROM GUIDE;
SELECT * FROM DELIVERABLE_PROJECT;
DESCRIBE GUIDE;
SELECT * FROM PANEL_MEMBERS;
SELECT * FROM USERS;
SELECT D.PROJECT_TITLE,D.PROJECT_DOMAIN,G.FIRST_NAME,G.LAST_NAME FROM DELIVERABLE_PROJECT AS D,STUDENT AS S,USERS AS U,PANEL_ALLOT AS P,GUIDE AS G WHERE D.USN = S.USN AND S.EMAIL = U.EMAIL AND D.PANEL_ID = P.PANEL_ID AND G.GUIDE_ID = P.GUIDE_ID AND U.EMAIL = 'santoshv.is20@rvce.edu.in';
INSERT INTO PANEL_ALLOT (Guide_ID,Panel_ID) VALUES ('1201',100), ('1202',104), ('1203',102), ('1204',103);

UPDATE GUIDE SET USN = '1RV20IS045' WHERE GUIDE_ID = '1201';
UPDATE GUIDE SET USN = '1RV20IS043' WHERE GUIDE_ID = '1204';
UPDATE GUIDE SET USN = '1RV20IS036' WHERE GUIDE_ID = '1203';
UPDATE GUIDE SET USN = '1RV20IS006' WHERE GUIDE_ID = '1202';

SELECT * FROM GUIDE;
SELECT * FROM PANEL_ALLOT;

SELECT * FROM USERS;
SELECT * FROM GUIDE;
SELECT S.USN, S.FIRST_NAME AS STUDENT_FIRST_NAME, S.LAST_NAME AS STUDENT_LAST_NAME, D.PROJECT_TITLE, D.PROJECT_DOMAIN FROM STUDENT AS S, DELIVERABLE_PROJECT AS D, GUIDE AS G, PANEL_ALLOT AS PA
WHERE S.USN = D.USN AND G.USN = S.USN AND G.PROJECT_ID = D.PROJECT_ID AND PA.PANEL_ID = D.PANEL_ID;

ALTER TABLE PHASE_ALLOT MODIFY LATE_SUBMISSION VARCHAR(25);

SELECT * FROM PHASE_ALLOT;

UPDATE PHASE_ALLOT SET LATE_SUBMISSION = "LATE" WHERE PHASE_ID = 1301;
UPDATE PHASE_ALLOT SET LATE_SUBMISSION = "LATE" WHERE PHASE_ID = 1302;

SELECT * FROM COORDINATOR;
ALTER TABLE COORDINATOR DROP FOREIGN KEY coordinator_ibfk_4;
ALTER TABLE COORDINATOR DROP PANEL_ID;
ALTER TABLE COORDINATOR DROP FOREIGN KEY coordinator_ibfk_2;
ALTER TABLE COORDINATOR DROP ID;
ALTER TABLE COORDINATOR DROP FOREIGN KEY coordinator_ibfk_3;
ALTER TABLE COORDINATOR DROP USN;

SELECT * FROM GUIDE;
SELECT * FROM DELIVERABLE_PROJECT;

SELECT * FROM COORDINATOR;
SELECT * FROM STUDENT;
SELECT FIRST_NAME,MIDDLE_NAME,LAST_NAME,EMAIL,PHONE_NO FROM STUDENT;
SELECT * FROM DIARY;
SELECT FIRST_NAME FROM STUDENT WHERE EMAIL = 'santoshv.is20@rvce.edu.in';
SELECT * FROM STUDENT;
SELECT * FROM STUDENT WHERE USN = '1RV20IS006';
UPDATE STUDENT SET FIRST_NAME = 'SANTOSH',PHONE_NO = '941302389' WHERE USN = '1RV20IS043';
SELECT * FROM STUDENT;

SELECT * FROM INTERNSHIP_GUIDE;
SELECT * FROM GUIDE_DOMAIN;
DESCRIBE GUIDE_DOMAIN;
DESCRIBE INTERNSHIP_GUIDE;
SELECT * FROM PHASE_ALLOT;

CREATE TABLE STUDENT_SUB (
SUBMISSION_ID INTEGER AUTO_INCREMENT PRIMARY KEY,
USN VARCHAR(25),
PHASE_ID INTEGER,
PROJECT_ID INTEGER,
SUBMITTED_AT DATETIME,
SUBMISSION_STATUS VARCHAR(25),
FOREIGN KEY (USN) REFERENCES STUDENT(USN) ON DELETE CASCADE,
FOREIGN KEY (PHASE_ID) REFERENCES PHASE_ALLOT(PHASE_ID) ON DELETE CASCADE,
FOREIGN KEY (PROJECT_ID) REFERENCES DELIVERABLE_PROJECT(PROJECT_ID)
);

SELECT * FROM PHASE_ALLOT;

CREATE TABLE SCHEDULE (
PHASE_NO INTEGER PRIMARY KEY,
PHASE_DESC INTEGER,
DUE_DATE DATE
);

SHOW TABLES;

ALTER TABLE SCHEDULE
MODIFY PHASE_DESC VARCHAR(100);

ALTER TABLE STUDENT_SUB
ADD FILE_SUBMIT VARCHAR(100);
SELECT * FROM STUDENT_SUB;



SELECT * FROM SCHEDULE;
SELECT * FROM PHASE_ALLOT;

INSERT INTO SCHEDULE (PHASE_NO,PHASE_DESC,DUE_DATE) VALUES
(1,'SYNOPSIS','2023-02-08'),
(2,'SRS','2023-02-13');

SELECT * FROM DIARY;
SELECT * FROM DELIVERABLE_PROJECT;

CREATE TABLE FILE_SUB (
SUB_ID INTEGER auto_increment PRIMARY KEY,
USN VARCHAR(25),
PHASE_NO INTEGER,
FILE VARCHAR(100) NOT NULL
);

ALTER TABLE PHASE_ALLOT
ADD FOREIGN KEY (PHASE_NO) REFERENCES SCHEDULE(PHASE_NO);

INSERT INTO PHASE_ALLOT VALUES (10032,1003,2,'2023-02-15');

UPDATE PHASE_ALLOT SET PHASE_ID = 10031 WHERE PHASE_ID = 1303;
UPDATE PHASE_ALLOT SET PHASE_ID = 10042 WHERE PHASE_ID = 1304;

UPDATE FILE_SUB SET SUB_ID = 1303 WHERE SUB_ID = 100;

INSERT INTO SCHEDULE (PHASE_NO,PHASE_DESC,DUE_DATE) VALUES (4,'DESIGN AND IMPLEMENTATION','2023-03-19'),(5,'SECURITY AND VALIDATION','2023-02-20'),(6,'MIDTERM REPORT','2023-03-01'),(7,'FINAL_DEMO','2023-03-10');

UPDATE FILE_SUB SET SUB_ID = 10031 WHERE SUB_ID = 1303;

ALTER TABLE FILE_SUB
ADD FOREIGN KEY (SUB_ID) REFERENCES PHASE_ALLOT(PHASE_ID);

DESCRIBE FILE_SUB;

CREATE TABLE TRANSACTIONS (
TRANSACTION_ID INTEGER auto_increment PRIMARY KEY,
SUB_ID INTEGER,
SUBMITTED_AT DATE,
SUB_STATUS VARCHAR(25),
FOREIGN KEY (SUB_ID) REFERENCES PHASE_ALLOT(PHASE_ID)
);
SELECT * FROM TRANSACTIONS;
SELECT * FROM DELIVERABLE_PROJECT;
SELECT * FROM PHASE_ALLOT;
SELECT * FROM FILE_SUB;
ALTER TABLE DELIVERABLE_PROJECT DROP COLUMN LATE_SUBMISSION;

INSERT INTO TRANSACTIONS VALUES (10000,10031,'2023-02-13','LATE');
UPDATE TRANSACTIONS SET TRANSACTION_ID = 11000 WHERE TRANSACTION_ID = 10000;
SELECT * FROM FILE_SUB;
SELECT S.PHASE_NO,S.PHASE_DESC,T.SUBMITTED_AT,T.SUB_STATUS FROM SCHEDULE AS S,TRANSACTIONS AS T,STUDENT AS ST,FILE_SUB AS F, PHASE_ALLOT AS PA, DELIVERABLE_PROJECT AS D WHERE T.SUB_ID = PA.PHASE_ID AND S.PHASE_NO = F.PHASE_NO AND PA.PROJECT_ID = D.PROJECT_ID AND F.USN = D.USN;

SELECT S.PHASE_NO,S.PHASE_DESC,T.SUBMITTED_AT,T.SUB_STATUS FROM SCHEDULE AS S,TRANSACTIONS AS T,FILE_SUB AS F,PHASE_ALLOT AS PA, DELIVERABLE_PROJECT AS D WHERE S.PHASE_NO = F.PHASE_NO AND T.SUB_ID = PA.PHASE_ID AND F.USN = D.USN;
SELECT * FROM TRANSACTIONS;
SELECT * FROM PHASE_ALLOT;
SELECT * FROM DELIVERABLE_PROJECT;
SELECT * FROM FILE_SUB;

SELECT F.SUB_ID,S.PHASE_NO,S.PHASE_DESC,T.SUBMITTED_AT FROM SCHEDULE AS S,TRANSACTIONS AS T,FILE_SUB AS F,PHASE_ALLOT AS PA, DELIVERABLE_PROJECT AS D WHERE S.PHASE_NO = F.PHASE_NO AND T.SUB_ID = PA.PHASE_ID AND F.USN = D.USN;
ALTER TABLE PHASE_ALLOT DROP COLUMN DUE_DATE;
ALTER TABLE PHASE_ALLOT DROP COLUMN LATE_SUBMISSION;
SELECT * FROM PHASE_ALLOT;
SELECT * FROM DELIVERABLE_PROJECT;
SELECT * FROM SCHEDULE;
INSERT INTO PHASE_ALLOT (PHASE_ID,PROJECT_ID,PHASE_NO) VALUES (10032,1003,2),(10041,1004,1),(10051,1005,1),(10052,1005,2);
SELECT * FROM FILE_SUB;
SELECT * FROM GUIDE;

SELECT * FROM DELIVERABLE_PROJECT;
DELETE FROM FILE_SUB WHERE SUB_ID = 10031;

SELECT * FROM STUDENT;
SELECT * FROM DELIVERABLE_PROJECT;

SELECT * FROM FILE_SUB;

SELECT * FROM GUIDE;

DESCRIBE DELIVERABLE_PROJECT;
DESCRIBE GUIDE;

SELECT * FROM TRANSACTIONS;
SELECT * FROM FILE_SUB;
SELECT * FROM PHASE_ALLOT;
SELECT * FROM SCHEDULE;
SELECT * FROM SCHEDULE;
INSERT INTO TRANSACTIONS (TRANSACTION_ID,SUB_ID,SUBMITTED_AT,SUB_STATUS) VALUES (11001,10032,'2023-02-15',"LATE"),(11002,10041,'2023-02-15',"LATE"),(11003,10051,'2023-02-15','ONTIME');
